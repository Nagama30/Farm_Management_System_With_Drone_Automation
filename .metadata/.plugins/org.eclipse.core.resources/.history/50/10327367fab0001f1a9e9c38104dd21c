package application;

import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;

public class DashboardManager {
    private static DashboardManager instance; // Singleton instance
    private Stage dashboardStage;            // The single stage for the dashboard

    // Private constructor to prevent instantiation
    private DashboardManager() {}

    // Public method to get the single instance
    public static DashboardManager getInstance() {
        if (instance == null) {
            instance = new DashboardManager();
        }
        return instance;
    }

    // Method to show the dashboard
    public void showDashboard() {
        if (dashboardStage != null && dashboardStage.isShowing()) {
            // If the dashboard is already open, bring it to the front
            dashboardStage.toFront();
            return;
        }

        try {
            // Load the FXML and set up the stage if not already done
            FXMLLoader loader = new FXMLLoader(getClass().getResource("MainScene.fxml"));
            Parent root = loader.load();

            // Create a new stage and configure it
            dashboardStage = new Stage();
            dashboardStage.setTitle("Farm Management Dashboard");
            Scene scene = new Scene(root, 1200, 800); // Set initial scene size
            dashboardStage.setScene(scene);

            // Set minimum and maximum window sizes
            dashboardStage.setMinWidth(1000);
            dashboardStage.setMinHeight(700);
            dashboardStage.setMaxWidth(1600);
            dashboardStage.setMaxHeight(1000);

            // Show the stage
            dashboardStage.show();

            // Set behavior for when the stage is closed
            dashboardStage.setOnCloseRequest(event -> {
                dashboardStage = null; // Reset the instance so a new one can be opened later
            });

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
